<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-list-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">Blog | SPR</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://www.supernetworks.org/pages/blog"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" property="og:title" content="Blog | SPR"><meta data-rh="true" name="description" content="Blog"><meta data-rh="true" property="og:description" content="Blog"><meta data-rh="true" name="docusaurus_tag" content="blog_posts_list"><meta data-rh="true" name="docsearch:docusaurus_tag" content="blog_posts_list"><link data-rh="true" rel="icon" href="/pages/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://www.supernetworks.org/pages/blog"><link data-rh="true" rel="alternate" href="https://www.supernetworks.org/pages/blog" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.supernetworks.org/pages/blog" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://6J0ST5YCC4-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"Blog","@id":"https://www.supernetworks.org/pages/blog","mainEntityOfPage":"https://www.supernetworks.org/pages/blog","headline":"Blog","description":"Blog","blogPost":[{"@type":"BlogPosting","@id":"https://www.supernetworks.org/pages/blog/loading-your-own-rust-kernel-modules","mainEntityOfPage":"https://www.supernetworks.org/pages/blog/loading-your-own-rust-kernel-modules","url":"https://www.supernetworks.org/pages/blog/loading-your-own-rust-kernel-modules","headline":"Loading Out of Tree Rust in Linux","name":"Loading Out of Tree Rust in Linux","description":"Rust is taking off in the Linux Kernel and improved support and features make it possible to develop drivers with Rust.","datePublished":"2024-08-19T00:00:00.000Z","author":{"@type":"Person","name":"Jeremy Goldberger","url":"https://github.com/jgoldberger26"},"keywords":[]},{"@type":"BlogPosting","@id":"https://www.supernetworks.org/pages/blog/bssid-randomization","mainEntityOfPage":"https://www.supernetworks.org/pages/blog/bssid-randomization","url":"https://www.supernetworks.org/pages/blog/bssid-randomization","headline":"BSSID Randomization","name":"BSSID Randomization","description":"How Does WiFi Location Positioning & Tracking Work?","datePublished":"2024-05-31T00:00:00.000Z","author":{"@type":"Person","name":"Alex Radocea","url":"https://twitter.com/defendtheworld"},"keywords":[]},{"@type":"BlogPosting","@id":"https://www.supernetworks.org/pages/blog/pi5-hardware-2024","mainEntityOfPage":"https://www.supernetworks.org/pages/blog/pi5-hardware-2024","url":"https://www.supernetworks.org/pages/blog/pi5-hardware-2024","headline":"PI5 Hats and More, Unleashing the Power of Modular Router Hardware","name":"PI5 Hats and More, Unleashing the Power of Modular Router Hardware","description":"Modular Router Hardware","datePublished":"2024-05-08T00:00:00.000Z","author":{"@type":"Person","name":"Alex Radocea","url":"https://twitter.com/defendtheworld"},"keywords":[]},{"@type":"BlogPosting","@id":"https://www.supernetworks.org/pages/blog/midnightsun-qualifiers-2024-dragonfly","mainEntityOfPage":"https://www.supernetworks.org/pages/blog/midnightsun-qualifiers-2024-dragonfly","url":"https://www.supernetworks.org/pages/blog/midnightsun-qualifiers-2024-dragonfly","headline":"Dragonfly Pake","name":"Dragonfly Pake","description":"Midnight Sun Qualifiers 2024","datePublished":"2024-04-22T00:00:00.000Z","author":{"@type":"Person","name":"Alex Radocea","url":"https://twitter.com/defendtheworld"},"keywords":[]},{"@type":"BlogPosting","@id":"https://www.supernetworks.org/pages/blog/spr-tailscale-integration","mainEntityOfPage":"https://www.supernetworks.org/pages/blog/spr-tailscale-integration","url":"https://www.supernetworks.org/pages/blog/spr-tailscale-integration","headline":"SPR Tailscale","name":"SPR Tailscale","description":"Introducing SPR-TailScale","datePublished":"2024-03-26T00:00:00.000Z","author":{"@type":"Person","name":"Alex Radocea","url":"https://twitter.com/defendtheworld"},"keywords":[]},{"@type":"BlogPosting","@id":"https://www.supernetworks.org/pages/blog/beacon-double-free-inet-wireless-daemon-CVE-2024-28084","mainEntityOfPage":"https://www.supernetworks.org/pages/blog/beacon-double-free-inet-wireless-daemon-CVE-2024-28084","url":"https://www.supernetworks.org/pages/blog/beacon-double-free-inet-wireless-daemon-CVE-2024-28084","headline":"Beacon Double Free in IWD","name":"Beacon Double Free in IWD","description":"CVE-2024-28084 Patched in Inet Wireless Daemon 2.16","datePublished":"2024-03-11T00:00:00.000Z","author":{"@type":"Person","name":"Alex Radocea","url":"https://twitter.com/defendtheworld"},"keywords":[]},{"@type":"BlogPosting","@id":"https://www.supernetworks.org/pages/blog/federal-focus-memory-corruption-2024","mainEntityOfPage":"https://www.supernetworks.org/pages/blog/federal-focus-memory-corruption-2024","url":"https://www.supernetworks.org/pages/blog/federal-focus-memory-corruption-2024","headline":"Software Safety Looks Different From The Other Side","name":"Software Safety Looks Different From The Other Side","description":"Memory Corruption Hardening is Controversial Now?","datePublished":"2024-03-01T00:00:00.000Z","author":{"@type":"Person","name":"Alex Radocea","url":"https://twitter.com/defendtheworld"},"keywords":[]},{"@type":"BlogPosting","@id":"https://www.supernetworks.org/pages/blog/isoon-wifi-exploitation-2024","mainEntityOfPage":"https://www.supernetworks.org/pages/blog/isoon-wifi-exploitation-2024","url":"https://www.supernetworks.org/pages/blog/isoon-wifi-exploitation-2024","headline":"What the I-Soon Leak Tells Us About WiFi Hacking","name":"What the I-Soon Leak Tells Us About WiFi Hacking","description":"The I Soon Dump","datePublished":"2024-02-22T00:00:00.000Z","author":{"@type":"Person","name":"Alex Radocea","url":"https://twitter.com/defendtheworld"},"keywords":[]},{"@type":"BlogPosting","@id":"https://www.supernetworks.org/pages/blog/spr-2024-alerts","mainEntityOfPage":"https://www.supernetworks.org/pages/blog/spr-2024-alerts","url":"https://www.supernetworks.org/pages/blog/spr-2024-alerts","headline":"Alerts to Improve Network Visibility","name":"Alerts to Improve Network Visibility","description":"Alerting Made Easy","datePublished":"2024-01-31T00:00:00.000Z","author":{"@type":"Person","name":"Alex Radocea","url":"https://twitter.com/defendtheworld"},"keywords":[]},{"@type":"BlogPosting","@id":"https://www.supernetworks.org/pages/blog/spr-2023-in-review","mainEntityOfPage":"https://www.supernetworks.org/pages/blog/spr-2023-in-review","url":"https://www.supernetworks.org/pages/blog/spr-2023-in-review","headline":"2023 Year in Review","name":"2023 Year in Review","description":"What a year it's been for the Secure Programmable Router (SPR) project! We've made great strides in empowering users to take control of their networks, prioritize privacy, and unlock network configurability. Let's dive right into the highlights of 2023 and peek at what's in store for the future.","datePublished":"2023-12-27T00:00:00.000Z","author":[{"@type":"Person","name":"Alex Radocea","url":"https://twitter.com/defendtheworld"},{"@type":"Person","name":"Philip Olausson","url":"https://twitter.com/capslcc"}],"keywords":[]}]}</script><link rel="alternate" type="application/rss+xml" href="/pages/blog/rss.xml" title="SPR RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/pages/blog/atom.xml" title="SPR Atom Feed">




<link rel="search" type="application/opensearchdescription+xml" title="SPR" href="/pages/opensearch.xml">


<link rel="preconnect" href="https://us.i.posthog.com">
<script>!function(t,e){var o,s,r,a;e.__SV||(window.posthog=e,e._i=[],e.init=function(i,n,p){function c(t,e){var o=e.split(".");2==o.length&&(t=t[o[0]],e=o[1]),t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}}(r=t.createElement("script")).type="text/javascript",r.async=!0,r.src=n.api_host.replace(".i.posthog.com","-assets.i.posthog.com")+"/static/array.js",(a=t.getElementsByTagName("script")[0]).parentNode.insertBefore(r,a);var g=e;for(void 0!==p?g=e[p]=[]:p="posthog",g.people=g.people||[],g.toString=function(t){var e="posthog";return"posthog"!==p&&(e+="."+p),t||(e+=" (stub)"),e},g.people.toString=function(){return g.toString(1)+".people (stub)"},o="capture identify alias people.set people.set_once set_config register register_once unregister opt_out_capturing has_opted_out_capturing opt_in_capturing reset isFeatureEnabled onFeatureFlags getFeatureFlag getFeatureFlagPayload reloadFeatureFlags group updateEarlyAccessFeatureEnrollment getEarlyAccessFeatures getActiveMatchingSurveys getSurveys onSessionId".split(" "),s=0;s<o.length;s++)c(g,o[s]);e._i.push([i,n,p])},e.__SV=1)}(document,window.posthog||[]),posthog.init("phc_wHrv9J5yEKPecDYT9ligBWKlIi2LBDL7I4heu69ayOT",{api_host:"https://us.i.posthog.com",id:"default"})</script><link rel="stylesheet" href="/pages/assets/css/styles.2174a242.css">
<script src="/pages/assets/js/runtime~main.5f4c1d25.js" defer="defer"></script>
<script src="/pages/assets/js/main.cb49ecb1.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/pages/docs/intro"><div class="navbar__logo"><img src="/pages/img/logo.png" alt="Secure Programmable Router" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/pages/img/logo.png" alt="Secure Programmable Router" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">SPR</b></a><a class="navbar__item navbar__link" href="/pages/docs/intro">Documentation</a><a class="navbar__item navbar__link" href="/pages/docs/setup_guides/setup_run_spr">Setup Guide</a><a class="navbar__item navbar__link" href="/pages/articles">Articles</a><a class="navbar__item navbar__link" href="/pages/api/0">API</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/pages/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/spr-networks/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">SPR GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">All posts</div><div role="group"><h3 class="yearGroupHeading_rMGB">2024</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/pages/blog/loading-your-own-rust-kernel-modules">Loading Out of Tree Rust in Linux</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/pages/blog/bssid-randomization">BSSID Randomization</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/pages/blog/pi5-hardware-2024">PI5 Hats and More, Unleashing the Power of Modular Router Hardware</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/pages/blog/midnightsun-qualifiers-2024-dragonfly">Dragonfly Pake</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/pages/blog/spr-tailscale-integration">SPR Tailscale</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/pages/blog/beacon-double-free-inet-wireless-daemon-CVE-2024-28084">Beacon Double Free in IWD</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/pages/blog/federal-focus-memory-corruption-2024">Software Safety Looks Different From The Other Side</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/pages/blog/isoon-wifi-exploitation-2024">What the I-Soon Leak Tells Us About WiFi Hacking</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/pages/blog/spr-2024-alerts">Alerts to Improve Network Visibility</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2023</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/pages/blog/spr-2023-in-review">2023 Year in Review</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/pages/blog/spr-nzyme-tap">Loading an nzyme tap on SPR</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/pages/blog/spr-mitmproxy">Transparent Socket Forwarding with SPR and MITMProxy</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/pages/blog/spr-nexmon">Loading up nexmon on a RPI4 with SPR</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/pages/blog/barely-ap-surfaces">Attack Surface Reduction Research (Part 1)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/pages/blog/scapy-revfrag">One Weird Trick to fix your CTF Payloads</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/pages/blog/virtual-spr-1click">How to use the SPR 1-click install on DigitalOcean</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/pages/blog/ios-app-released">SPR Now Available on the iOS App Store</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/pages/blog/barely-ap">Barely AP is Almost an Access Point</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/pages/blog/spr-turtles-march">March 2023&#x27;s Turtles Challenge</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/pages/blog/january-2023-turtles">January 2023&#x27;s Turtles Challenge</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2022</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/pages/blog/virtual-spr-on-a-gcloud-tier-free-instance">Run Virtual SPR on a Google Cloud Free Tier Instance</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/pages/blog/virtual-spr-on-a-aws-micro-tier-instance">Run Virtual SPR on a AWS Micro Tier Instance</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/pages/blog/virtual-spr-on-a-digital-ocean-droplet">Run Virtual SPR on a DigitalOcean Droplet</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/pages/blog/virtual SPR">SPR in the cloud</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/pages/blog/secure router chaining">Securely Chaining Routers</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/pages/blog/multipsk and wpa3">SPR Supports WPA3 with Multiple Passwords</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/pages/blog/wifi6">Gigabit WiFi with SPR &amp; The 4x4 MT7915</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/pages/blog/spr_mini_pc">Running SPR on a Mini PC with WiFi 6</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/pages/blog/UI Push">Supernetworks just Released a React User Interface</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/pages/blog/first-blog-post">Announcing The SPR Project</a></li></ul></div></nav></aside><main class="col col--7"><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/pages/blog/loading-your-own-rust-kernel-modules">Loading Out of Tree Rust in Linux</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2024-08-19T00:00:00.000Z">August 19, 2024</time> · <!-- -->10 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://github.com/jgoldberger26" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp">Jeremy Goldberger</span></a></div><div class="authorSocials_rSDt"></div></div></div></div></div></header><div class="markdown"><p>Rust is <a href="https://blog.rust-lang.org/2024/08/12/Project-goals.html" target="_blank" rel="noopener noreferrer">taking off</a> in the Linux Kernel and improved support and features make it possible to develop drivers with Rust.</p>
<p>It&#x27;s no secret that C is not a memory-safe language. In the router world, there are <a href="https://x.com/router_bugs" target="_blank" rel="noopener noreferrer">tons of bugs</a> that surface, many related to memory safety. These bugs are often rooted in low-level device firmware and kernel drivers, making them very dangerous and difficult to work with. Supernetworks is exploring ways of moving wireless protocol parsing out of firmware and drivers and pushing them into userland, with a minimal custom kernel module. Writing this module in Rust would avoid many of the safety pitfalls of C.</p>
<p>The 6.9 Linux release landed Rust support for arm64 which opens the door for us to use Rust for our arm64 based hardware.</p>
<p>One challenge is how to distribute kernel code to users. It’s difficult to maintain a kernel branch so we’d like to explore distributing an out of tree kernel module instead. So when Ubuntu finally lands kernels with Rust for ARM64 (expected to be this year), we’ll be able to distribute a Rust module to load in directly.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="tldr">TL;DR<a href="#tldr" class="hash-link" aria-label="Direct link to TL;DR" title="Direct link to TL;DR">​</a></h2>
<p>Rust abstractions can be put out of tree with your module, they don&#x27;t need to be compiled in with the kernel. Bindgen still works, since it doesn&#x27;t change the kernel ABI. Helper functions that wrap inlined functions and macros can just be put inside of another external module, and the compiler will figure out the dependency chain.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="out-of-tree-modules">Out of Tree Modules<a href="#out-of-tree-modules" class="hash-link" aria-label="Direct link to Out of Tree Modules" title="Direct link to Out of Tree Modules">​</a></h2>
<p>With Out of Tree Modules, developers can build Linux Kernel Modules and ship them separately from the loaded Linux kernel build. These modules aren&#x27;t baked into the Linux kernel. Instead, they rely on symbols that the kernel exports to call into kernel code, allowing them to draw on the vast capabilities of the Linux kernel. With Rust, however, calling into the kernel is a little more complicated.</p>
<p>One of the main problems with writing external modules in Rust is that individual subsystems have little built-in support for Rust, as of the time of writing this article. Each subsystem has many functions that drivers can expect to exist in the kernel ABI, but these functions don&#x27;t have Rust abstractions written for them, at least not ones rolled into the kernel. The Linux kernel developers are hopeful that coverage for Rust <a href="https://www.kernel.org/doc/html/latest/rust/general-information.html#abstractions" target="_blank" rel="noopener noreferrer">abstractions</a> will increase in time, but for now, it is not feasible to write a safe external module for the mainline Linux kernel without these abstractions. To understand how we can use Rust in external kernel modules, let&#x27;s first explore what Rust abstractions are and why they&#x27;re important.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-are-abstractions">What are abstractions?<a href="#what-are-abstractions" class="hash-link" aria-label="Direct link to What are abstractions?" title="Direct link to What are abstractions?">​</a></h2>
<p>Rust, as a systems programming language, has essentially seamless integration with C through a Foreign Function Interface (FFI). Using the <code>extern</code> keyword, Rust can make a call to any C function in the kernel as if it were a normal Rust function, with no changes to the kernel. There is only one notable exception: Memory safety guarantees are dropped.</p>
<p>When C code is compiled, all functions except for inline functions and macros are given symbols. These symbols are exposed through the Application Binary Interface (ABI), allowing other code to call those functions. The ABI contains information such as parameter types, return types, and more, but no information about memory safety. If we want to use Rust&#x27;s memory safety model, we need to specify these guarantees ourselves, with Rust code. By writing abstraction layers around FFI calls, we can manually define what Rust should expect regarding memory safety. Take this example, based on a similar one from <a href="https://doc.rust-lang.org/book/ch19-01-unsafe-rust.html#using-extern-functions-to-call-external-code" target="_blank" rel="noopener noreferrer">The Rust Book</a>:</p>
<div class="language-C language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">int</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">c_abs</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">int</span><span class="token plain"> num</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">abs</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">num</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// EXPORT_SYMBOL_GPL(c_abs);</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">c_abs_in_place</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">int</span><span class="token operator">*</span><span class="token plain"> num</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	</span><span class="token operator">*</span><span class="token plain">num </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">abs</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token operator">*</span><span class="token plain">num</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// EXPORT_SYMBOL_GPL(c_abs_in_place);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-Rust language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">extern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;C&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	</span><span class="token comment" style="color:rgb(98, 114, 164)">// Define our extern functions. This doesn&#x27;t compile to anything, it just</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	</span><span class="token comment" style="color:rgb(98, 114, 164)">// tells Rust to expect that it will be able to use these functions with</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	</span><span class="token comment" style="color:rgb(98, 114, 164)">// these symbols</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(80, 250, 123)">c_abs</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">num</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">i32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">i32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	</span><span class="token comment" style="color:rgb(98, 114, 164)">// Note that &#x27;mut&#x27; isn&#x27;t strictly required. Omitting it would still compile,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	</span><span class="token comment" style="color:rgb(98, 114, 164)">// but it would break Rust&#x27;s memory safety guarantees, allowing the programmer</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	</span><span class="token comment" style="color:rgb(98, 114, 164)">// to make a mistake.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(80, 250, 123)">c_abs_in_place</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">num</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token operator">*</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">mut</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">i32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// We wrap the FFI call in an abstraction, so that we can isolate the unsafe call</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// here. If we didn&#x27;t have this, we would have to use unsafe in our main function,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// which would make it hard to figure out where memory safety bugs happen.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(80, 250, 123)">rust_abs</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">num</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">i32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">i32</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	</span><span class="token comment" style="color:rgb(98, 114, 164)">// SAFETY: This is just an FFI call.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">unsafe</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">c_abs</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">num</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(80, 250, 123)">rust_abs_in_place</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">num</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">mut</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">i32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	</span><span class="token comment" style="color:rgb(98, 114, 164)">// SAFETY: Since num is a reference, we know its pointer is still valid.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	</span><span class="token comment" style="color:rgb(98, 114, 164)">// Otherwise, this is just an FFI call.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">unsafe</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">c_abs_in_place</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">num </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">as</span><span class="token plain"> </span><span class="token operator">*</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">mut</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">i32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(80, 250, 123)">main</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	</span><span class="token comment" style="color:rgb(98, 114, 164)">// Since we used safe abstractions, we don&#x27;t need to use unsafe code</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	</span><span class="token comment" style="color:rgb(98, 114, 164)">// in our main function.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> foo </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">rust_abs</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">mut</span><span class="token plain"> bar </span><span class="token operator">=</span><span class="token plain"> </span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	</span><span class="token function" style="color:rgb(80, 250, 123)">rust_abs_in_place</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token operator">&amp;</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">mut</span><span class="token plain"> bar</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// Note that rust forces us to use mut because</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">								 </span><span class="token comment" style="color:rgb(98, 114, 164)">// of how we defined our safe wrapper.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	</span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Foo is {} and bar is {}!&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> foo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> bar</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">		   </span><span class="token comment" style="color:rgb(98, 114, 164)">// Foo is 5 and bar is 5!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Since abstractions are wrappers around essential subsystem functions, they would normally be rolled into the kernel so any driver could access them. That way, each C subsystem function only needs to be wrapped once. Any module or driver, out-of-tree or not, could then use them without having to rewrite the abstraction for every single driver.</p>
<p>As we saw before, abstractions are just normal Rust code that wraps an <code>unsafe</code> function. So, what&#x27;s the problem with just moving it out-of-tree and putting it with your other code? There&#x27;s none, it really is that easy! While abstractions solve most of our issues, there are some issues that it doesn&#x27;t solve. To understand why, let&#x27;s look at bindgen and how it works.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="why-bindgen-isnt-a-problem">Why Bindgen isn&#x27;t a problem<a href="#why-bindgen-isnt-a-problem" class="hash-link" aria-label="Direct link to Why Bindgen isn&#x27;t a problem" title="Direct link to Why Bindgen isn&#x27;t a problem">​</a></h2>
<p>As the name implies, bindgen automatically generates bindings for Rust code. These bindings are the same as the <code>extern</code> block above, only a lot more complicated. The only confusion is that bindgen must be compiled with the kernel, but it doesn&#x27;t change the ABI. The only things that go in the <code>extern</code> block are definitions: function prototypes, constants, and structure definitions that don&#x27;t compile to anything. Instead, in the case of function prototypes, they&#x27;re used by the Rust compiler to place symbols. When the linker links all the object files together, it will find the C function symbols that were exposed by bindgen, and call it from Rust. Bindgen doesn&#x27;t create anything new; it just exposes existing symbols to Rust.</p>
<p>Now, can call into any exported symbol that exists in the C kernel. But there is one more challenge: Handling macros and inline functions in our Rust modules.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="macros-and-inlines">Macros and Inlines<a href="#macros-and-inlines" class="hash-link" aria-label="Direct link to Macros and Inlines" title="Direct link to Macros and Inlines">​</a></h2>
<p>Macros and inline functions are different from regular functions in that they don&#x27;t get assigned a symbol. Instead, they are directly inserted during pre-processing or compilation. These functions aren&#x27;t in the kernel ABI, so we don&#x27;t have any way to access them from Rust!</p>
<p>The way this is normally handled in the kernel is by generating helper functions, like this:</p>
<div class="language-C language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">rust_helper_mutex_lock</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">struct</span><span class="token plain"> </span><span class="token class-name">mutex</span><span class="token plain"> </span><span class="token operator">*</span><span class="token plain">lock</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">mutex_lock</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">lock</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">EXPORT_SYMBOL_GPL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">rust_helper_mutex_lock</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Each of these helper functions is compiled into the kernel and given a symbol so that they can be used from Rust. This is convenient for making use of commonly used macros and inline functions from multiple places. However, our focus is on distributing the external module without having to distribute a kernel as well. Since these helper functions generate symbols that would not be present in the mainline kernel, running our driver would require a custom kernel.</p>
<p>To generate these symbols externally, we must write our own helpers with our external module. Unlike abstractions, these helpers aren&#x27;t just more Rust code. They&#x27;re C code that needs to be compiled first. We can compile these helper functions using another external module.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="depending-on-an-external-module">Depending on an external module<a href="#depending-on-an-external-module" class="hash-link" aria-label="Direct link to Depending on an external module" title="Direct link to Depending on an external module">​</a></h2>
<p>By simply writing these functions in a C file and specifying it as a module, we can generate symbols for C functions. Then, by compiling both the Rust and C modules together, the Linux kernel&#x27;s build system will automatically figure out that the Rust module depends on the C helper module!</p>
<div class="language-C language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">// SPDX-License-Identifier: GPL-2.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(189, 147, 249);font-style:italic">include</span><span class="token macro property"> </span><span class="token macro property string" style="color:rgb(255, 121, 198)">&lt;linux/module.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(189, 147, 249);font-style:italic">include</span><span class="token macro property"> </span><span class="token macro property string" style="color:rgb(255, 121, 198)">&lt;linux/kernel.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(189, 147, 249);font-style:italic">include</span><span class="token macro property"> </span><span class="token macro property string" style="color:rgb(255, 121, 198)">&lt;linux/version.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">int</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">linux_version_code</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">int</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">linux_version_code</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	</span><span class="token comment" style="color:rgb(98, 114, 164)">// We can&#x27;t access LINUX_VERSION_CODE in Rust because it&#x27;s defined</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	</span><span class="token comment" style="color:rgb(98, 114, 164)">// using #define. This helper function exports it to rust. This</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	</span><span class="token comment" style="color:rgb(98, 114, 164)">// works with macros and inline functions as well.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> LINUX_VERSION_CODE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">EXPORT_SYMBOL_GPL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">linux_version_code</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">MODULE_LICENSE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;GPL&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">MODULE_AUTHOR</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Jeremy Goldberger&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">MODULE_DESCRIPTION</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;A simple helper module.&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-Rust language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">// SPDX-License-Identifier: GPL-2.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">//! Inspired by Rust hello world example by Adrea Righi</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">use</span><span class="token plain"> </span><span class="token namespace">kernel</span><span class="token namespace punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token namespace">prelude</span><span class="token namespace punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token operator">*</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token macro property">module!</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">type</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token class-name">ModuleExample</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;oot_example&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    author</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Jeremy Goldberger&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    description</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Rust external module example&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    license</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;GPL&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">struct</span><span class="token plain"> </span><span class="token type-definition class-name">ModuleExample</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">impl</span><span class="token plain"> </span><span class="token namespace">kernel</span><span class="token namespace punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token class-name">Module</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> </span><span class="token class-name">ModuleExample</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(80, 250, 123)">init</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">_module</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token lifetime-annotation symbol" style="color:rgb(248, 248, 242)">&#x27;static</span><span class="token plain"> </span><span class="token class-name">ThisModule</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-&gt;</span><span class="token plain"> </span><span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">Self</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token macro property">pr_info!</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Hello from Rust\n&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token macro property">pr_info!</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;The current time according to C is {}.\n&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">rust_ktime_get</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token macro property">pr_info!</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;The current linux version according to C is {}.\n&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">rust_linux_version_code</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token class-name">Ok</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token class-name">ModuleExample</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(80, 250, 123)">rust_ktime_get</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">i64</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// Note that we don&#x27;t need to define ktime_get() in an extern block anywhere;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// it was already done in bindgen! Even if it wasn&#x27;t, we could add whatever</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// header we wanted to bindings_helper, and we could use it without messing</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// up the kernel ABI.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">unsafe</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token namespace">kernel</span><span class="token namespace punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token namespace">bindings</span><span class="token namespace punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token function" style="color:rgb(80, 250, 123)">ktime_get</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">extern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;C&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// We define this extern block ourselves. Because it&#x27;s a helper function</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// that doesn&#x27;t exist in the Linux kernel, bindgen wouldn&#x27;t be able</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// to generate it without doing some weird stuff.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(80, 250, 123)">linux_version_code</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-&gt;</span><span class="token plain"> </span><span class="token namespace">core</span><span class="token namespace punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token namespace">ffi</span><span class="token namespace punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token plain">c_int</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(80, 250, 123)">rust_linux_version_code</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">i32</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">unsafe</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">linux_version_code</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>There is already a <a href="https://github.com/torvalds/linux/blob/master/rust/kernel/time.rs" target="_blank" rel="noopener noreferrer">ktime abstraction</a> written for Rust. I was running 6.9 here, so it wasn&#x27;t available here. That abstraction leverages Rust types to make it more robust, a common theme in abstractions more complex than the ones above.</p></div></div>
<p>Running the module in a qemu instance:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">ubuntu@ubuntu-24-cloud-image:~$ ls</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">helpers.ko  rust_module.ko</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ubuntu@ubuntu-24-cloud-image:~$ uname -r</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">6.9.0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ubuntu@ubuntu-24-cloud-image:~$ lsmod</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Module                  Size  Used by</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ubuntu@ubuntu-24-cloud-image:~$ sudo insmod rust_module.ko</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">insmod: ERROR: could not insert module rust_module.ko: Unknown symbol in module</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ubuntu@ubuntu-24-cloud-image:~$ sudo insmod helpers.ko</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ubuntu@ubuntu-24-cloud-image:~$ sudo insmod rust_module.ko</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ubuntu@ubuntu-24-cloud-image:~$ lsmod</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Module                  Size  Used by</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">rust_module            12288  0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">helpers                12288  1 rust_module</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ubuntu@ubuntu-24-cloud-image:~$ sudo dmesg</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[   37.728226] rust_module: loading out-of-tree module taints kernel.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[   37.729919] rust_module: Unknown symbol linux_version_code (err -2)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[   62.071684] oot_example: Hello from Rust</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[   62.073836] oot_example: The current time according to C is 62047385799.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[   62.074243] oot_example: The current linux version according to C is 395520.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Note that the first time we tried to load the module, it threw an error because our <code>helpers</code> module wasn&#x27;t loaded. The second time, it loaded correctly, since it found the <code>linux_version_code</code> symbol in our helper module. Additionally, when we ran <code>lsmod</code>, we saw that <code>helpers</code> was listed as a dependency of <code>rust_module</code>.</p>
<p>Now, we have an external module written in Rust, but we can make full use of existing C infrastructure even if it&#x27;s not baked into the kernel yet! By leveraging external modules, we can start benefiting from Rust&#x27;s safety features in kernel development without waiting for full mainline support. The rapid development of Rust support in the Linux kernel means that many of these workarounds will become unnecessary over time. As more subsystems gain native Rust abstractions, writing Rust kernel modules will become increasingly straightforward and powerful.</p>
<p>The potential for Rust in the Linux kernel is vast, and we&#x27;re just at the beginning. Whether you&#x27;re a seasoned kernel developer or new to systems programming like I am, now is an exciting time to get involved and contribute to open-source development.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/pages/blog/tags/rust">rust</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/pages/blog/tags/kernel">kernel</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/pages/blog/tags/linux">linux</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/pages/blog/tags/wifi">wifi</a></li></ul></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/pages/blog/bssid-randomization">BSSID Randomization</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2024-05-31T00:00:00.000Z">May 31, 2024</time> · <!-- -->3 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://twitter.com/defendtheworld" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp">Alex Radocea</span></a></div><div class="authorSocials_rSDt"></div></div></div></div></div></header><div class="markdown"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-does-wifi-location-positioning--tracking-work">How Does WiFi Location Positioning &amp; Tracking Work?<a href="#how-does-wifi-location-positioning--tracking-work" class="hash-link" aria-label="Direct link to How Does WiFi Location Positioning &amp; Tracking Work?" title="Direct link to How Does WiFi Location Positioning &amp; Tracking Work?">​</a></h2>
<p>All Apple Smartphones and Laptops as well as Google Devices passively collect Access Point Names (the SSID) and their hardware address (the BSSID), and they then tag it with the GPS location. With billions of customers, tech giants have been able to build databases that contain the physical position of almost every access point in the world.</p>
<p>Researchers from the University of Maryland published that the privacy features in the public APIs were insufficient to protect the privacy of individuals.
<a href="https://www.cs.umd.edu/~dml/papers/wifi-surveillance-sp24.pdf" target="_blank" rel="noopener noreferrer">See the paper from Erik Rye, Dave Levin for the details: &quot;Surveilling the Masses with Wi-Fi-Based Positioning Systems&quot; </a></p>
<p>Krebs On Security has a through review of the issue: <a href="https://krebsonsecurity.com/2024/05/why-your-wi-fi-router-doubles-as-an-apple-airtag/" target="_blank" rel="noopener noreferrer">&quot;Why Your Wi-Fi Router Doubles as an Apple AirTag&quot;</a></p></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/pages/blog/tags/wifi-positioning">wifi positioning</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/pages/blog/tags/privacy">privacy</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/pages/blog/tags/tracking">tracking</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/pages/blog/tags/apple">apple</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/pages/blog/tags/google">google</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about BSSID Randomization" href="/pages/blog/bssid-randomization"><b>Read more</b></a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/pages/blog/pi5-hardware-2024">PI5 Hats and More, Unleashing the Power of Modular Router Hardware</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2024-05-08T00:00:00.000Z">May 8, 2024</time> · <!-- -->4 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://twitter.com/defendtheworld" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp">Alex Radocea</span></a></div><div class="authorSocials_rSDt"></div></div></div></div></div></header><div class="markdown"><div style="display:flex;justify-content:center;align-items:center"><img src="/pages/assets/images/logopuzzle-02d5bc1d39938265e169b7df32ba4f65.png" style="width:50%"></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="modular-router-hardware">Modular Router Hardware<a href="#modular-router-hardware" class="hash-link" aria-label="Direct link to Modular Router Hardware" title="Direct link to Modular Router Hardware">​</a></h2>
<p>I&#x27;m excited to announce that Supernetworks will be releasing Compute Module based and Pi5 Expansion HAT based access points. The HATs and Compute Modules are expected to be generally available this summer.</p>
<p>The second tenant of Sustainability is Reuse. Companies like <a href="https://frame.work/" target="_blank" rel="noopener noreferrer">Framework</a> have been spearheading the charge towards a better form of computing by building upgradable laptops and soon other devices.</p>
<p>With what the Raspberry Pi Foundation offers people, we are able to bring some of the benefits of modular computing to Access Points as well. Modularity takes ownership one step further, letting people reuse the hardware for other projects, and upgrade it to make it powerful, without any soldering required.</p></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/pages/blog/tags/pi-5">pi5</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/pages/blog/tags/raspberry">raspberry</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/pages/blog/tags/hardware">hardware</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about PI5 Hats and More, Unleashing the Power of Modular Router Hardware" href="/pages/blog/pi5-hardware-2024"><b>Read more</b></a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/pages/blog/midnightsun-qualifiers-2024-dragonfly">Dragonfly Pake</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2024-04-22T00:00:00.000Z">April 22, 2024</time> · <!-- -->7 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://twitter.com/defendtheworld" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp">Alex Radocea</span></a></div><div class="authorSocials_rSDt"></div></div></div></div></div></header><div class="markdown"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="midnight-sun-qualifiers-2024">Midnight Sun Qualifiers 2024<a href="#midnight-sun-qualifiers-2024" class="hash-link" aria-label="Direct link to Midnight Sun Qualifiers 2024" title="Direct link to Midnight Sun Qualifiers 2024">​</a></h2>
<p>Over the weekend a ctf team I help with, <a href="https://hackingforsoju.team/" target="_blank" rel="noopener noreferrer">HackingForSoju</a>, hosted the Midnight Sun CTF Qualifiers.
The finals will take place in <a href="https://conf.midnightsunctf.com/" target="_blank" rel="noopener noreferrer">Stockholm, Sweden on June 14-16</a>.</p>
<p>I put together a <a href="https://gist.github.com/lts-rad/a557f5eb2d4456bbe209d524bdfbfd23" target="_blank" rel="noopener noreferrer">challenge</a> around WPA3&#x27;s Password Authenticated Key Exchange: <a href="https://datatracker.ietf.org/doc/html/rfc7664" target="_blank" rel="noopener noreferrer">Dragonfly</a></p>
<p>WPA3 has quite a few notes during our our wifi training where we discuss the background to the protocol, because it was so very worrisome from the start.</p>
<p><img decoding="async" loading="lazy" alt="trouble" src="/pages/assets/images/wpa3trouble-d0ed718a7ac2fb3aa54ae6b7f8c6253c.png" width="1572" height="1606" class="img_ev3q"></p></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/pages/blog/tags/dragonfly">dragonfly</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/pages/blog/tags/sae">sae</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/pages/blog/tags/cryptography">cryptography</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/pages/blog/tags/ctf">ctf</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/pages/blog/tags/wifi">wifi</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about Dragonfly Pake" href="/pages/blog/midnightsun-qualifiers-2024-dragonfly"><b>Read more</b></a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/pages/blog/spr-tailscale-integration">SPR Tailscale</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2024-03-26T00:00:00.000Z">March 26, 2024</time> · <!-- -->2 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://twitter.com/defendtheworld" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp">Alex Radocea</span></a></div><div class="authorSocials_rSDt"></div></div></div></div></div></header><div class="markdown"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="introducing-spr-tailscale">Introducing SPR-TailScale<a href="#introducing-spr-tailscale" class="hash-link" aria-label="Direct link to Introducing SPR-TailScale" title="Direct link to Introducing SPR-TailScale">​</a></h2>
<p>We&#x27;ve released a new iteration of the <a href="https://github.com/spr-networks/spr-tailscale" target="_blank" rel="noopener noreferrer">TailScale integration for SPR</a>!
This plugin was put together with <a href="https://twitter.com/willy_wong" target="_blank" rel="noopener noreferrer">@willy_wong</a>.</p>
<p><img decoding="async" loading="lazy" alt="spr-tailscale" src="/pages/assets/images/combo-6570affc7ea16f7b29e7fafdfb216593.png" width="2210" height="1218" class="img_ev3q"></p></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/pages/blog/tags/tailscale">tailscale</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/pages/blog/tags/wireguard">wireguard</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/pages/blog/tags/microsegmentation">microsegmentation</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/pages/blog/tags/vpn">vpn</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/pages/blog/tags/plugins">plugins</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about SPR Tailscale" href="/pages/blog/spr-tailscale-integration"><b>Read more</b></a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/pages/blog/beacon-double-free-inet-wireless-daemon-CVE-2024-28084">Beacon Double Free in IWD</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2024-03-11T00:00:00.000Z">March 11, 2024</time> · <!-- -->3 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://twitter.com/defendtheworld" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp">Alex Radocea</span></a></div><div class="authorSocials_rSDt"></div></div></div></div></div></header><div class="markdown"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="cve-2024-28084-patched-in-inet-wireless-daemon-216">CVE-2024-28084 Patched in Inet Wireless Daemon 2.16<a href="#cve-2024-28084-patched-in-inet-wireless-daemon-216" class="hash-link" aria-label="Direct link to CVE-2024-28084 Patched in Inet Wireless Daemon 2.16" title="Direct link to CVE-2024-28084 Patched in Inet Wireless Daemon 2.16">​</a></h2>
<p>While preparing some wifi security training, we found a double free vulnerability affecting
APs and Stations running <a href="https://iwd.wiki.kernel.org/" target="_blank" rel="noopener noreferrer"><code>iwd</code></a>. This issue was reported and <a href="https://git.kernel.org/pub/scm/network/wireless/iwd.git/commit/?id=52a47c9fd428904de611a90cbf8b223af879684d" target="_blank" rel="noopener noreferrer">patched</a> with fixes available starting in version 2.16.</p></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/pages/blog/tags/iwd">iwd</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/pages/blog/tags/memory-corruption">memory-corruption</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/pages/blog/tags/wifi">wifi</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/pages/blog/tags/cve-2024-28084">CVE-2024-28084</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about Beacon Double Free in IWD" href="/pages/blog/beacon-double-free-inet-wireless-daemon-CVE-2024-28084"><b>Read more</b></a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/pages/blog/federal-focus-memory-corruption-2024">Software Safety Looks Different From The Other Side</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2024-03-01T00:00:00.000Z">March 1, 2024</time> · <!-- -->4 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://twitter.com/defendtheworld" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp">Alex Radocea</span></a></div><div class="authorSocials_rSDt"></div></div></div></div></div></header><div class="markdown"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="memory-corruption-hardening-is-controversial-now">Memory Corruption Hardening is Controversial Now?<a href="#memory-corruption-hardening-is-controversial-now" class="hash-link" aria-label="Direct link to Memory Corruption Hardening is Controversial Now?" title="Direct link to Memory Corruption Hardening is Controversial Now?">​</a></h2>
<p>Social Media has a lot of criticism lately for the push for memory safety as a metric for the labeling of software security.
Between software supply chain susceptibility, command injection, and logic bugs obliterating software regularly,
it doesn&#x27;t seem like its the best candidate for a software safety metric.</p>
<p>The background for why the federal government is reporting in the area is <a href="https://www.whitehouse.gov/briefing-room/presidential-actions/2021/05/12/executive-order-on-improving-the-nations-cybersecurity/" target="_blank" rel="noopener noreferrer">E.O. 14028</a></p>
<p>From the EO there&#x27;s several pushes for software and network safety. These are things like requiring Zero Trust Access for the Federal Government, EDR on federal systems for monitoring and responding to attacks,  SBOMs for supply chain safety, and creating safety standards for IOT devices. Although the main focus is the federal government there&#x27;s an aim to push out software safety standards to the public as a whole.</p>
<p>And it&#x27;s regulation for consumers that I see getting some criticism. NIST&#x27;s key areas interact with the labeling of safety for IOT and consumer software -- which has everyone skeptical because the government may not seem to be the best equipped for leading edge software practices, and regulatory overhead will raise the burden for software developers without necessarily moving software security forward.</p>
<p><img decoding="async" loading="lazy" src="https://www.nist.gov/sites/default/files/images/2022/04/27/EO-task_and-timeline.png" alt="nist-timeline" class="img_ev3q"></p>
<p>On memory safety specifically, two key documents have been released over the past two quarters. The first is <a href="https://www.cisa.gov/sites/default/files/2023-12/The-Case-for-Memory-Safe-Roadmaps-508c.pdf" target="_blank" rel="noopener noreferrer">CISA&#x27;s report on Memory Safety</a>.
The second is the <a href="https://www.whitehouse.gov/wp-content/uploads/2024/02/Final-ONCD-Technical-Report.pdf" target="_blank" rel="noopener noreferrer">ONCD Report on Measuring Memory Safety</a>.</p></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/pages/blog/tags/usgov">usgov</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/pages/blog/tags/fedgov">fedgov</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/pages/blog/tags/memory-corruption">memory-corruption</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/pages/blog/tags/safety">safety</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about Software Safety Looks Different From The Other Side" href="/pages/blog/federal-focus-memory-corruption-2024"><b>Read more</b></a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/pages/blog/isoon-wifi-exploitation-2024">What the I-Soon Leak Tells Us About WiFi Hacking</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2024-02-22T00:00:00.000Z">February 22, 2024</time> · <!-- -->3 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://twitter.com/defendtheworld" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp">Alex Radocea</span></a></div><div class="authorSocials_rSDt"></div></div></div></div></div></header><div class="markdown"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-i-soon-dump">The I Soon Dump<a href="#the-i-soon-dump" class="hash-link" aria-label="Direct link to The I Soon Dump" title="Direct link to The I Soon Dump">​</a></h2>
<p>&quot;The documents come from iSoon, also known as Auxun, a Chinese firm headquartered in Shanghai that sells third-party hacking and data-gathering services to Chinese government bureaus, security groups and state-owned enterprises. &quot;</p>
<p>The <a href="https://www.washingtonpost.com/world/2024/02/21/china-hacking-leak-documents-isoon/" target="_blank" rel="noopener noreferrer">Washington Post</a> writes that
&quot;The documents show that iSoon met and worked with members of APT41, a Chinese hacking group that was charged by the U.S. Justice Department in 2020 for targeting more than 100 video game firms, universities and other victims worldwide.&quot;</p></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/pages/blog/tags/spyware">spyware</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/pages/blog/tags/wifi">wifi</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/pages/blog/tags/implants">implants</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about What the I-Soon Leak Tells Us About WiFi Hacking" href="/pages/blog/isoon-wifi-exploitation-2024"><b>Read more</b></a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/pages/blog/spr-2024-alerts">Alerts to Improve Network Visibility</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2024-01-31T00:00:00.000Z">January 31, 2024</time> · <!-- -->4 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://twitter.com/defendtheworld" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp">Alex Radocea</span></a></div><div class="authorSocials_rSDt"></div></div></div></div></div></header><div class="markdown"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="alerting-made-easy">Alerting Made Easy<a href="#alerting-made-easy" class="hash-link" aria-label="Direct link to Alerting Made Easy" title="Direct link to Alerting Made Easy">​</a></h2>
<p>We&#x27;ve rolled out a lightweight alerting mechanism built right inside of SPR.</p>
<p>So SPR already has an event system and we wanted to improve the existing notification system
as well as persist alerts for later.</p>
<p>We wanted something with the following properties:</p>
<ul>
<li>Allow powerful matching expressions</li>
<li>Work with our lightweight key-value database for concurrent access</li>
<li>Minimal system performance impact</li>
<li>User Customizable, in UX with minimal coding</li>
</ul></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/pages/blog/tags/spr">SPR</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/pages/blog/tags/alerts">alerts</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/pages/blog/tags/jpath">jpath</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/pages/blog/tags/events">events</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about Alerts to Improve Network Visibility" href="/pages/blog/spr-2024-alerts"><b>Read more</b></a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/pages/blog/spr-2023-in-review">2023 Year in Review</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2023-12-27T00:00:00.000Z">December 27, 2023</time> · <!-- -->5 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://twitter.com/defendtheworld" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp">Alex Radocea</span></a></div><div class="authorSocials_rSDt"></div></div></div></div><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://twitter.com/capslcc" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp">Philip Olausson</span></a></div><div class="authorSocials_rSDt"></div></div></div></div></div></header><div class="markdown"><p><strong>What a year it&#x27;s been for the Secure Programmable Router (SPR) project!</strong> We&#x27;ve made great strides in empowering users to take control of their networks, prioritize privacy, and unlock network configurability. Let&#x27;s dive right into the highlights of 2023 and peek at what&#x27;s in store for the future.</p>
<p><img decoding="async" loading="lazy" alt="device-list" src="/pages/assets/images/demo-screenshot-4fada3be970ecc66a3ac005cc64907e2.png" width="3002" height="1370" class="img_ev3q"></p></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/pages/blog/tags/spr">SPR</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/pages/blog/tags/ios">IOS</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/pages/blog/tags/microsegmentation">microsegmentation</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/pages/blog/tags/plus">PLUS</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about 2023 Year in Review" href="/pages/blog/spr-2023-in-review"><b>Read more</b></a></div></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"><a class="pagination-nav__link pagination-nav__link--next" href="/pages/blog/page/2"><div class="pagination-nav__label">Older entries</div></a></nav></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">SPR Links</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/pages/">SPR Homepage</a></li><li class="footer__item"><a class="footer__link-item" href="/pages/docs/intro">Documentation</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discord.gg/EUjTKJPPAX" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/spr_networks" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title"> </div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/pages/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/spr-networks/" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Supernetworks, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script>!function(){function t(){const t=document.querySelectorAll("div.markdown");Array.from(t).filter((t=>"blogPost"===t.parentNode.getAttribute("itemprop"))).forEach((t=>{if(!t.nextSibling||!t.nextSibling.classList.contains("custom-section")){const e=document.createElement("div");e.classList.add("custom-section"),e.innerHTML='\n          <br/>\n<br/>\n<h3>Connect with the SPR Community</h3>\n<ul>\n  <li><b>Get in the loop</b>: <a href="https://sendfox.com/supernetworks">Subscribe</a> to our Newsletter</li>\n  <li><b>Collaborate</b>:  <a href="https://github.com/spr-networks/super">Check out</a> our GitHub</li>\n  <li><b>Chat with us</b>: <a href="https://discord.gg/EUjTKJPPAX">Join our Discord</a> or <a href="https://twitter.com/spr_networks">Follow us</a> on Twitter</li>\n</ul>\n<br/>\n\n        ',t.parentNode.insertBefore(e.cloneNode(!0),t.nextSibling)}}))}new MutationObserver(((e,o)=>{document.querySelector("article")&&t()})).observe(document,{childList:!0,subtree:!0}),t()}()</script></body>
</html>