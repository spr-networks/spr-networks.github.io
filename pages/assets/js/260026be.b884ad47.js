"use strict";(self.webpackChunkspr_docs=self.webpackChunkspr_docs||[]).push([[9592],{14460:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>d,frontMatter:()=>o,metadata:()=>n,toc:()=>h});var n=i(51935),s=i(74848),a=i(28453);const o={slug:"agentic-insecurity-vibes-on-bitchat",title:"Identity Is A Bitchat Challenge (MITM Flaw)",authors:["ltsrad"],tags:["e2e","identity","bluetooth"]},r=void 0,l={authorsImageUrls:[void 0]},h=[{value:"The Intersection of Vibe Coding and Security",id:"the-intersection-of-vibe-coding-and-security",level:2},{value:"Vibe Identity: An Obvious Flaw",id:"vibe-identity-an-obvious-flaw",level:2},{value:"The Favorites Identity System",id:"the-favorites-identity-system",level:2},{value:"The MITM Attack",id:"the-mitm-attack",level:2},{value:"The Cryptographic Toolbox We Should Be Using",id:"the-cryptographic-toolbox-we-should-be-using",level:2},{value:"The Bigger Picture",id:"the-bigger-picture",level:2},{value:"Reporting The Issue",id:"reporting-the-issue",level:2},{value:"Moving Forward",id:"moving-forward",level:2},{value:"Final Thoughts",id:"final-thoughts",level:2}];function c(e){const t={a:"a",h2:"h2",img:"img",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.h2,{id:"the-intersection-of-vibe-coding-and-security",children:"The Intersection of Vibe Coding and Security"}),"\n",(0,s.jsx)(t.p,{children:"Many of us have seen glimpses of what agentic generative coding does for security. We see the missteps, and sometimes wonder about the shallow bugs that pile on. Config managers that are almost always arbitrary file upload endpoints. Glue layers that become bash command launch as a service. And most frustratingly, code generation that's excellent at pretending forward progress has been made when no meaningful change has occurred. One of the most impressive parts of agentic coding is exactly that: how convincing it is by appearance and how easily we're tricked about the depth of substance in the code gen. In some ways we extend our trust of people to the stochastic code parrots, assuming that generative coding produced the actual work a human would have probably performed."}),"\n",(0,s.jsx)(t.h2,{id:"vibe-identity-an-obvious-flaw",children:"Vibe Identity: An Obvious Flaw"}),"\n",(0,s.jsx)(t.p,{children:"I'm no stranger to e2e breaks, and have been following along over the past decade. Some of my favorite breaks I have found personally include Vaudenay oracles against Kakao, LINE, and bypassable OTR signature verification in iCloud Keychain compromising the password sync."}),"\n",(0,s.jsx)(t.p,{children:"So this morning when bitchat came up I took some time to look through the code and write up some demos. My first thought was we really don't want or need another protocol, many aspects of Noise would fit in for finer points around true forward secrecy."}),"\n",(0,s.jsx)(t.p,{children:"But bitchat's most glaring issue is identity. There's essentially no trust/auth built in today. So I would not really think about this as a secure messenger. The protocol has an identity key system, but it's only decorative as implemented and has misleading security claims. The 32-byte public key gets shuffled around with ephemeral key pairs as an opaque blob. The user verification is unfortunately disconnected from any trust and authentication. These are the hallmarks of vibe code (in)security."}),"\n",(0,s.jsx)(t.p,{children:"Secure messaging systems do usually provide a way for users to establish trust, and that's what bitchat does not have right now."}),"\n",(0,s.jsx)(t.p,{children:"Some possible mechanisms:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"QR codes"}),"\n",(0,s.jsx)(t.li,{children:"Preshared keys"}),"\n",(0,s.jsx)(t.li,{children:"Visual fingerprint verification ^"}),"\n",(0,s.jsx)(t.li,{children:"Third party vending"}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"^ Visual fingerprints are very tricky. For Telegram v1, I reported a problem with the SHA1 truncation to 128 bits, leading to a 2^64 birthday attack against the visual verification. It's possible to find near matches visually that may fool humans very easily as well. The current Telegram is still missing a lot of fundamental features, so I would actively discourage its use today."}),"\n",(0,s.jsx)(t.h2,{id:"the-favorites-identity-system",children:"The Favorites Identity System"}),"\n",(0,s.jsxs)(t.p,{children:['However bitchat does have a "Favorite" system in which a client is supposed to forever store a Public Key/Peer Id pair. This is essentially trust on first chat, but there is no trust built into the protocol because the Identity ',(0,s.jsx)("s",{children:"vibe"})," key doesn't authenticate anything."]}),"\n",(0,s.jsx)(t.h2,{id:"the-mitm-attack",children:"The MITM Attack"}),"\n",(0,s.jsx)(t.p,{children:'The broken identity authentication/verification enables a trivial man-in-the-middle attacks with the "Favorites" feature'}),"\n",(0,s.jsx)(t.p,{children:"You're Alice."}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:["An attacker intercepts and presents ",(0,s.jsx)(t.strong,{children:"Bob's Identity Key"}),", along with their own ephemeral pair"]}),"\n",(0,s.jsx)(t.li,{children:"bitchat accepts this because it can't verify the ephemerals belong to the real Bob, as the Identity key does no authentication"}),"\n",(0,s.jsx)(t.li,{children:'You think you\'re chatting with Bob, one of your marked "favorites", since they have a Star.'}),"\n",(0,s.jsx)(t.li,{children:'The attacker pretending to be "Bob" asks you, Alice, about your favorite secrets'}),"\n",(0,s.jsx)(t.li,{children:"Devastatingly, you leak to the adversary"}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"bobmitm",src:i(93312).A+"",width:"1934",height:"1214"})}),"\n",(0,s.jsx)(t.p,{children:"Then perhaps a little bit later the real bob shows up. This is how the rest of the conversation could go."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"bobmitm",src:i(51929).A+"",width:"1920",height:"1212"})}),"\n",(0,s.jsx)(t.h2,{id:"the-cryptographic-toolbox-we-should-be-using",children:"The Cryptographic Toolbox We Should Be Using"}),"\n",(0,s.jsx)(t.p,{children:"These problems are completely avoidable. We have battle-tested protocols:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Signal Protocol"}),": The gold standard via libsignal"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Noise Protocol Framework"}),": Modern, flexible framework for secure communication"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"OTR"}),": Proven secure messaging protocol"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Existing Decentralized Solutions"}),": Briar and Reticulum have already tackled decentralized messaging. I am not familiar with the insides of these but they are worth looking into working with instead of re-rolling yet another thing to lock down."]}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"the-bigger-picture",children:"The Bigger Picture"}),"\n",(0,s.jsx)(t.p,{children:"BitChat illustrates a common pattern: it's fun to break ground and rewrite a path as if it's new, but cryptography and trust is treacherously easy to get confused about and notoriously difficult to write cleanly and securely due to fundamental security oversights and implementation issues. Secure messaging is largely a solved problem. We have the tools and expertise to build systems that are both decentralized and secure."}),"\n",(0,s.jsx)(t.p,{children:"Thinking more deeply about this I think cryptography is the easy part. It will be the resilience to denial of service and electronic disruption that will challenge any decentralized communication mechanism when it's most needed."}),"\n",(0,s.jsx)(t.h2,{id:"reporting-the-issue",children:"Reporting The Issue"}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.a,{href:"https://github.com/jackjackbits/bitchat/issues/19",children:(0,s.jsx)(t.img,{alt:"trouble",src:i(84220).A+"",width:"1120",height:"874"})})}),"\n",(0,s.jsx)(t.h2,{id:"moving-forward",children:"Moving Forward"}),"\n",(0,s.jsx)(t.p,{children:"For projects like bitchat:"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsx)(t.li,{children:"Start with security fundamentals\u2014identity/trust isn't optional with encryption."}),"\n",(0,s.jsx)(t.li,{children:"Reuse proven protocols\u2014don't reinvent the cryptographic wheel"}),"\n",(0,s.jsx)(t.li,{children:"Think like an attacker"}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"final-thoughts",children:"Final Thoughts"}),"\n",(0,s.jsx)(t.p,{children:"In cryptography, details matter. A protocol that has the right vibes can have fundamental substance flaws that compromise everything it claims to protect."}),"\n",(0,s.jsx)(t.p,{children:"For users: wait for more mature implementations that take security seriously. For developers: learn from others' mistakes. The tools for building secure, decentralized communication exist. Use them."})]})}function d(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},28453:(e,t,i)=>{i.d(t,{R:()=>o,x:()=>r});var n=i(96540);const s={},a=n.createContext(s);function o(e){const t=n.useContext(a);return n.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),n.createElement(a.Provider,{value:t},e.children)}},51929:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/bob-later-3c87c72a1c5f1848bd0fc2cac6bda3e0.png"},51935:e=>{e.exports=JSON.parse('{"permalink":"/pages/blog/agentic-insecurity-vibes-on-bitchat","source":"@site/blog/2025-07-07-bitchat-missing-identity-security.md","title":"Identity Is A Bitchat Challenge (MITM Flaw)","description":"The Intersection of Vibe Coding and Security","date":"2025-07-07T00:00:00.000Z","tags":[{"inline":true,"label":"e2e","permalink":"/pages/blog/tags/e-2-e"},{"inline":true,"label":"identity","permalink":"/pages/blog/tags/identity"},{"inline":true,"label":"bluetooth","permalink":"/pages/blog/tags/bluetooth"}],"readingTime":4.33,"hasTruncateMarker":true,"authors":[{"name":"Alex Radocea","url":"https://twitter.com/defendtheworld","key":"ltsrad","page":null}],"frontMatter":{"slug":"agentic-insecurity-vibes-on-bitchat","title":"Identity Is A Bitchat Challenge (MITM Flaw)","authors":["ltsrad"],"tags":["e2e","identity","bluetooth"]},"unlisted":false,"prevItem":{"title":"Real-World Test: PoE+ Router Pushes 3+ Gbps Simultaneously on WiFi 6 & 2.5GbE","permalink":"/pages/blog/spr-poe-router-3gbps-throughput"},"nextItem":{"title":"SMB Flaws in macOS","permalink":"/pages/blog/macos-smb-flaws"}}')},84220:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/reported-128499e7e173d99f18e766cb2df02701.png"},93312:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/bob-4603cde3438196c3bb9b388fd420ea5c.png"}}]);