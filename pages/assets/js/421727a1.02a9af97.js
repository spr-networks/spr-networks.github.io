"use strict";(self.webpackChunkspr_docs=self.webpackChunkspr_docs||[]).push([[8921],{9933:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>d,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>o,toc:()=>l});var n=s(85893),i=s(11151);const r={sidebar_position:11},a="Alerts",o={id:"guides/alerts",title:"Alerts",description:"Overview",source:"@site/docs/guides/alerts.md",sourceDirName:"guides",slug:"/guides/alerts",permalink:"/pages/docs/guides/alerts",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:11,frontMatter:{sidebar_position:11},sidebar:"tutorialSidebar",previous:{title:"Logs and Events",permalink:"/pages/docs/guides/logs"},next:{title:"Docker Tips & Tricks",permalink:"/pages/docs/guides/development/docker-dev"}},d={},l=[{value:"Overview",id:"overview",level:2},{value:"Viewing &amp; Resolving Alerts",id:"viewing--resolving-alerts",level:2},{value:"Add Alerts",id:"add-alerts",level:2},{value:"Conditions",id:"conditions",level:3},{value:"Event Templating",id:"event-templating",level:3},{value:"Decorators",id:"decorators",level:4}];function c(e){const t={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",img:"img",p:"p",strong:"strong",...(0,i.a)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.header,{children:(0,n.jsx)(t.h1,{id:"alerts",children:"Alerts"})}),"\n",(0,n.jsx)(t.h2,{id:"overview",children:"Overview"}),"\n",(0,n.jsx)(t.p,{children:"Built into SPR is an alerting mechanism. When an event arrives that matches an alert\nconfiguration, an alert can be presented as a Notification or stored into the Event Database\nas an alert to be resolved at a later time."}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"alerts-overview",src:s(50088).Z+"",width:"2880",height:"1562"})}),"\n",(0,n.jsx)(t.h2,{id:"viewing--resolving-alerts",children:"Viewing & Resolving Alerts"}),"\n",(0,n.jsxs)(t.p,{children:["To see alerts stored in the database head over to the ",(0,n.jsx)(t.code,{children:"Alerts"})," page."]}),"\n",(0,n.jsxs)(t.p,{children:["Alerts have a 'State' variable which is currently one of ",(0,n.jsx)(t.code,{children:"New"})," or ",(0,n.jsx)(t.code,{children:"Resolved"}),". Click the resolve or resolve all buttons to move\nalert events to the Triaged state."]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"alerts-resolve",src:s(92462).Z+"",width:"2852",height:"1652"})}),"\n",(0,n.jsx)(t.h2,{id:"add-alerts",children:"Add Alerts"}),"\n",(0,n.jsx)(t.p,{children:"The alert rules are a little bit complicated seeming at first but they are flexible\nand configurable.\nCheck out the default templates to see how they are configured for different events, conditions and templates."}),"\n",(0,n.jsxs)(t.p,{children:["Alerts match an ",(0,n.jsx)(t.em,{children:"Event Prefix"}),". In the example below, we match ",(0,n.jsx)(t.code,{children:"wifi:auth:success"})," events, triggered when a device connects to the wifi. Read more about built-in event ",(0,n.jsx)(t.a,{href:"/pages/docs/services/sprbus#available-events",children:"here"})," or navigate to ",(0,n.jsx)(t.em,{children:"Monitor->Events"})," in the menu to list triggered events for your device."]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"alerts-add",src:s(73212).Z+"",width:"2880",height:"1343"})}),"\n",(0,n.jsxs)(t.p,{children:["We optionally copy the MAC address for the device and resolve this to a device name using a ",(0,n.jsx)(t.a,{href:"#decorators",children:"decorator"})," in the alert body."]}),"\n",(0,n.jsxs)(t.p,{children:["If you want to have the alert also show the interface, can specify this as alert body:\n",(0,n.jsx)(t.code,{children:"Authentication success for {{MAC#Device}} on interface {{Iface}}"})," and add Iface to fields or copy all of them."]}),"\n",(0,n.jsx)(t.h3,{id:"conditions",children:"Conditions"}),"\n",(0,n.jsxs)(t.p,{children:["Click ",(0,n.jsx)(t.strong,{children:"Add Condition Filter +"})," to create field requirements  beyond the event topic prefix.\nIf ",(0,n.jsx)(t.em,{children:"Match All"})," is set, then all conditions must match, otherwise just one. The conditions can also be logically inverted."]}),"\n",(0,n.jsxs)(t.p,{children:["In the following screenshot, the ",(0,n.jsx)(t.em,{children:"Event Prefix"})," is set to ",(0,n.jsx)(t.code,{children:"dns:serve:"}),", which is triggered when a client lookup a domain.\nWe add a condition that the domain should be ",(0,n.jsx)(t.em,{children:'"supernetworks.org."'})," (extra dot for dns syntax), if its a match a info alert will show with the device and domain name."]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"alerts-condition",src:s(276).Z+"",width:"2880",height:"1560"})}),"\n",(0,n.jsxs)(t.p,{children:["The syntax used for the event matchings uses JSONPath. See ",(0,n.jsx)(t.a,{href:"https://jsonpath.com/",children:"https://jsonpath.com/"})," for details.\nUse the selector for selecting fields. Regexp is supported, example: ",(0,n.jsx)(t.code,{children:'FirstName=~"^[0-9]+.[a-z]+.$"'})," to match numeric domains."]}),"\n",(0,n.jsx)(t.h3,{id:"event-templating",children:"Event Templating"}),"\n",(0,n.jsxs)(t.p,{children:["In addition to custom event matches, alert titles and bodies can be written as templates for what to render in the frontend.\nIn general, take the field to display and wrap it in curly brackets, for example: ",(0,n.jsx)(t.code,{children:"{{Ethernet.SrcMAC}}"}),"."]}),"\n",(0,n.jsx)(t.h4,{id:"decorators",children:"Decorators"}),"\n",(0,n.jsxs)(t.p,{children:["The event template also supports decorators. The following are supported: ",(0,n.jsx)(t.code,{children:"Device"}),", ",(0,n.jsx)(t.code,{children:"DeviceIcon"}),", ",(0,n.jsx)(t.code,{children:"DeviceName"}),", ",(0,n.jsx)(t.code,{children:"DeviceIP"}),", ",(0,n.jsx)(t.code,{children:"DeviceMAC"}),'.\nTo apply a decorator follow up a field name with "#Decorator". This allows converting a MAC address to a device\'s known IP for example,\nor rendering the assigned device icon for that device.']}),"\n",(0,n.jsxs)(t.p,{children:["Here is an example template with decorators:\n",(0,n.jsx)(t.code,{children:"MAC IP Violation {{IP.SrcIP#Device}} {{IP.SrcIP}} {{Ethernet.SrcMAC}} to {{IP.DstIP}} {{Ethernet.DstMAC}}"})]})]})}function h(e={}){const{wrapper:t}={...(0,i.a)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(c,{...e})}):c(e)}},276:(e,t,s)=>{s.d(t,{Z:()=>n});const n=s.p+"assets/images/alerts-add-conditions-77340793d921c3591388b113544a1b94.png"},73212:(e,t,s)=>{s.d(t,{Z:()=>n});const n=s.p+"assets/images/alerts-add-a1db099947586701de606317be190e31.png"},50088:(e,t,s)=>{s.d(t,{Z:()=>n});const n=s.p+"assets/images/alerts-overview-d5e7da7dec59633aa0c6ddc31986bf74.png"},92462:(e,t,s)=>{s.d(t,{Z:()=>n});const n=s.p+"assets/images/alerts-resolve-48b54709b09d7bc8dcb76a046babdcd9.png"},11151:(e,t,s)=>{s.d(t,{Z:()=>o,a:()=>a});var n=s(67294);const i={},r=n.createContext(i);function a(e){const t=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),n.createElement(r.Provider,{value:t},e.children)}}}]);