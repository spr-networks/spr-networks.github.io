"use strict";(self.webpackChunkspr_docs=self.webpackChunkspr_docs||[]).push([[2513],{91245:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>d,frontMatter:()=>i,metadata:()=>s,toc:()=>l});var r=n(85893),a=n(11151);const i={slug:"spr-conntrack-hardening",title:"Security Fixes & Conntrack Hardening in SPR",authors:["ltsrad"],tags:["firewall","conntrack"]},o=void 0,s={permalink:"/pages/blog/spr-conntrack-hardening",source:"@site/blog/2024-10-16-conntrack-hardening.md",title:"Security Fixes & Conntrack Hardening in SPR",description:"Anvil Secure recently published a post and whitepaper covering conntrack flaws that are common with many linux routers and linux \"multihomed\" devices. In this post we'll cover SPR, how our process mitigated the highest risk vulnerabilities, how we fixed the rest and other improvements we're making to be resilient against attacks like this in the future.",date:"2024-10-16T00:00:00.000Z",tags:[{inline:!0,label:"firewall",permalink:"/pages/blog/tags/firewall"},{inline:!0,label:"conntrack",permalink:"/pages/blog/tags/conntrack"}],readingTime:7.46,hasTruncateMarker:!0,authors:[{name:"Alex Radocea",url:"https://twitter.com/defendtheworld",key:"ltsrad",page:null}],frontMatter:{slug:"spr-conntrack-hardening",title:"Security Fixes & Conntrack Hardening in SPR",authors:["ltsrad"],tags:["firewall","conntrack"]},unlisted:!1,nextItem:{title:"Locking Down Multicast Services with SPR",permalink:"/pages/blog/spr-and-cups-multicast-vulnerability"}},c={authorsImageUrls:[void 0]},l=[{value:"Overview",id:"overview",level:2}];function h(e){const t={a:"a",h2:"h2",p:"p",...(0,a.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(t.p,{children:["Anvil Secure recently published a ",(0,r.jsx)(t.a,{href:"https://anvilsecure.com/blog/spoofing-internal-packets-for-multihomed-linux-devices.html",children:"post"})," and ",(0,r.jsx)(t.a,{href:"https://www.anvilsecure.com/wp-content/uploads/2024/10/Conntrack-Spoofing-Internal-Packets-Whitepaper-1.pdf",children:"whitepaper"})," covering conntrack flaws that are common with many linux routers and linux \"multihomed\" devices. In this post we'll cover SPR, how our process mitigated the highest risk vulnerabilities, how we fixed the rest and other improvements we're making to be resilient against attacks like this in the future."]}),"\n",(0,r.jsx)(t.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.a,{href:"https://conntrack-tools.netfilter.org/manual.html",children:"Conntrack"})," is part of Linux Netfilter and is an integral part of a stateful firewall for allowing Network Address Translation on a network.  A router uses it to allow clients to establish connections through the uplink interfaces."]}),"\n",(0,r.jsx)(t.p,{children:"Anvil Secure published details on how devices often fail to lock down their firewalls correctly since Conntrack operates at layer 3. External attackers that are one hop away can abuse this to spoof IP addresses and send traffic to internal interfaces on devices and routers for an established connection managed with conntrack.  For most of our users, this limits the attack to compromised or hostile ISP providers, which is an uncommon (but not unheard of attack vector).  However, since the WiFi Pod can be used as a travel router, it's important to us that they are can withstand being attached to a hostile network."}),"\n",(0,r.jsx)(t.p,{children:"The riskiest of the attacks happen to not affect SPR."})]})}function d(e={}){const{wrapper:t}={...(0,a.a)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},11151:(e,t,n)=>{n.d(t,{Z:()=>s,a:()=>o});var r=n(67294);const a={},i=r.createContext(a);function o(e){const t=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:o(e.components),r.createElement(i.Provider,{value:t},e.children)}}}]);