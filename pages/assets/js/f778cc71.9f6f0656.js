"use strict";(self.webpackChunkspr_docs=self.webpackChunkspr_docs||[]).push([[6733],{154:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>c,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"development/apis/ssl_support","title":"SSL Support","description":"The API service looks for a certificate at configs/base/www-api.crt and the corresponding key configs/base/www-api.key.","source":"@site/docs/development/apis/ssl_support.md","sourceDirName":"development/apis","slug":"/development/apis/ssl_support","permalink":"/pages/docs/development/apis/ssl_support","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Authentication","permalink":"/pages/docs/development/apis/p_webapi_authentication"},"next":{"title":"Docker Tips & Tricks","permalink":"/pages/docs/development/contribute/docker-dev"}}');var i=n(74848),r=n(28453);const c={},l="SSL Support",o={},a=[{value:"Enable SSL web api",id:"enable-ssl-web-api",level:3},{value:"Install CA Certificate on macOS",id:"install-ca-certificate-on-macos",level:2},{value:"Install CA Certificate on iOS",id:"install-ca-certificate-on-ios",level:2}];function d(e){const t={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.header,{children:(0,i.jsx)(t.h1,{id:"ssl-support",children:"SSL Support"})}),"\n",(0,i.jsxs)(t.p,{children:["The API service looks for a certificate at ",(0,i.jsx)(t.code,{children:"configs/base/www-api.crt"})," and the corresponding key ",(0,i.jsx)(t.code,{children:"configs/base/www-api.key"}),".\nIf they exist the api will listen on port 443 for TLS-encrypted requests."]}),"\n",(0,i.jsx)(t.p,{children:"Use the provided script to generate a self-signed certificate."}),"\n",(0,i.jsx)(t.h3,{id:"enable-ssl-web-api",children:"Enable SSL web api"}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.strong,{children:"Generate a certificate"})}),"\n"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"D=./ ./api/scripts/generate-certificate.sh\n"})}),"\n",(0,i.jsxs)(t.ol,{start:"2",children:["\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.strong,{children:"Restart api container"})}),"\n"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"docker compose restart api # (or restart api-virt if using the virtualized network variant)\n\n"})}),"\n",(0,i.jsxs)(t.ol,{start:"3",children:["\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.strong,{children:"Verify the SSL service is running"})}),"\n"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"curl -k https://127.0.0.1\n"})}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.em,{children:"See next section on how to trust the certificate."})}),"\n",(0,i.jsxs)(t.ol,{start:"4",children:["\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.strong,{children:"Open port 443 for WAN access (optional)"})}),"\n"]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.em,{children:(0,i.jsx)(t.strong,{children:"NOTE"})})," This is not recommended if running SPR on the internet."]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:'echo "UPSTREAM_SERVICES_ENABLE=1" >> configs/base/config.sh\ndocker compose restart api # (or restart api-virt if using the virtualized network variant)\n'})}),"\n",(0,i.jsx)(t.h2,{id:"install-ca-certificate-on-macos",children:"Install CA Certificate on macOS"}),"\n",(0,i.jsx)(t.p,{children:"In order to interact with SPR using HTTPS without getting a warning, you need to install a CA certificate for SPR on your macOS device."}),"\n",(0,i.jsx)(t.p,{children:"To install the CA certificate to your macOS device:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"Make sure that your network is connected to SPR"}),"\n",(0,i.jsxs)(t.li,{children:["Use the browser on your macOS device to go to ",(0,i.jsx)(t.a,{href:"http://spr.local/cert",children:"http://spr.local/cert"})]}),"\n",(0,i.jsx)(t.li,{children:"When the CA certificate downloads, open it with Keychain Access"}),"\n",(0,i.jsxs)(t.li,{children:["Open the ",(0,i.jsx)(t.em,{children:"Keychain Access"})," app"]}),"\n",(0,i.jsxs)(t.li,{children:["Click ",(0,i.jsx)(t.strong,{children:"File -> Import items"})," and select the downloaded certificate (cert.crt)"]}),"\n",(0,i.jsxs)(t.li,{children:["Double-click the entry for ",(0,i.jsx)(t.code,{children:"spr"}),". In the dialog that opens, expand the ",(0,i.jsx)(t.strong,{children:"Trust"})," section and select ",(0,i.jsx)(t.strong,{children:"Always Trust"})]}),"\n",(0,i.jsx)(t.li,{children:"Close the window to save your settings"}),"\n"]}),"\n",(0,i.jsxs)(t.p,{children:["Verify the certificate is working by visiting ",(0,i.jsx)(t.a,{href:"https://spr.local",children:"https://spr.local"})]}),"\n",(0,i.jsx)(t.h2,{id:"install-ca-certificate-on-ios",children:"Install CA Certificate on iOS"}),"\n",(0,i.jsx)(t.p,{children:"In order to interact with SPR using HTTPS, you need to install a CA certificate for SPR on your iOS device."}),"\n",(0,i.jsx)(t.p,{children:"To install the CA certificate to your iOS device:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"Make sure that your network is connected to SPR"}),"\n",(0,i.jsxs)(t.li,{children:["Use the browser on your iOS device to go to ",(0,i.jsx)(t.a,{href:"http://spr.local/cert",children:"http://spr.local/cert"})," (or click the link in the app)"]}),"\n",(0,i.jsxs)(t.li,{children:["When the CA certificate downloads, select ",(0,i.jsx)(t.em,{children:"Profile downloaded"})," in the Settings menu"]}),"\n",(0,i.jsxs)(t.li,{children:["On the ",(0,i.jsx)(t.strong,{children:"Install Profile"})," screen, select ",(0,i.jsx)(t.strong,{children:"Install"})]}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"ios-cert-install",src:n(46338).A+"",width:"750",height:"796"})}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["When the profile is installed, select ",(0,i.jsx)(t.strong,{children:"Done"})]}),"\n",(0,i.jsxs)(t.li,{children:["Go to ",(0,i.jsx)(t.strong,{children:"Settings > General > About > Certificate Trust Settings"}),"*"]}),"\n",(0,i.jsxs)(t.li,{children:["Activate the toggle switch for ",(0,i.jsx)(t.code,{children:"spr"})]}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"ios-cert-trust",src:n(82645).A+"",width:"750",height:"606"})}),"\n",(0,i.jsxs)(t.p,{children:["Verify the certificate is working by visiting ",(0,i.jsx)(t.a,{href:"https://spr.local",children:"https://spr.local"})," on your iOS device or run the SPR app and select https in the login form."]})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>c,x:()=>l});var s=n(96540);const i={},r=s.createContext(i);function c(e){const t=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),s.createElement(r.Provider,{value:t},e.children)}},46338:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/ios-cert-install-9b3233cb505c83da921fac1557e4803c.png"},82645:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/ios-cert-trust-bd8dd347c5c6800c77ffc3e663d62412.png"}}]);