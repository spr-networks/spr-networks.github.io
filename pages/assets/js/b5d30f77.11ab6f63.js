"use strict";(self.webpackChunkspr_docs=self.webpackChunkspr_docs||[]).push([[929],{62263:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>r,toc:()=>d});var i=s(85893),n=s(11151);const a={slug:"wpa3-needs-decoyauth",title:"Advancing DecoyAuth is Key to Making WiFi & WPA3 More Secure",authors:["ltsrad"],tags:["iot","segmentation","isolation"]},o=void 0,r={permalink:"/pages/blog/wpa3-needs-decoyauth",source:"@site/blog/2025-03-06-decoyauth-wpa3-multipass.md",title:"Advancing DecoyAuth is Key to Making WiFi & WPA3 More Secure",description:"Pioneering WiFi Security",date:"2025-03-06T00:00:00.000Z",tags:[{inline:!0,label:"iot",permalink:"/pages/blog/tags/iot"},{inline:!0,label:"segmentation",permalink:"/pages/blog/tags/segmentation"},{inline:!0,label:"isolation",permalink:"/pages/blog/tags/isolation"}],readingTime:3.35,hasTruncateMarker:!0,authors:[{name:"Alex Radocea",url:"https://twitter.com/defendtheworld",key:"ltsrad",page:null}],frontMatter:{slug:"wpa3-needs-decoyauth",title:"Advancing DecoyAuth is Key to Making WiFi & WPA3 More Secure",authors:["ltsrad"],tags:["iot","segmentation","isolation"]},unlisted:!1,nextItem:{title:"How to sleep better when your bed is a backdoor",permalink:"/pages/blog/sleep-better-backdoors"}},l={authorsImageUrls:[void 0]},d=[{value:"Pioneering WiFi Security",id:"pioneering-wifi-security",level:2},{value:"The Challenges of WPA3 Multipass",id:"the-challenges-of-wpa3-multipass",level:2},{value:"1. Only one device can be added at a time",id:"1-only-one-device-can-be-added-at-a-time",level:4},{value:"2. MAC Randomization",id:"2-mac-randomization",level:4},{value:"3. Password Sync Breakage",id:"3-password-sync-breakage",level:4},{value:"Existing Workarounds",id:"existing-workarounds",level:3},{value:"DecoyAuth Proposes Advancing Oblivious PAKE (O-PAKE) to resolve WPA3 Multipass",id:"decoyauth-proposes-advancing-oblivious-pake-o-pake-to-resolve-wpa3-multipass",level:2},{value:"A Call To Action",id:"a-call-to-action",level:2}];function c(e){const t={a:"a",code:"code",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",p:"p",ul:"ul",...(0,n.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.h2,{id:"pioneering-wifi-security",children:"Pioneering WiFi Security"}),"\n",(0,i.jsxs)(t.p,{children:["Supernetwork's ",(0,i.jsx)(t.a,{href:"https://github.com/spr-networks/super",children:"flagship project, SPR, "})," is a pioneer in\nWiFi security and we've supported multi-pass WPA3 from the inception of the project in 2022."]}),"\n",(0,i.jsx)(t.p,{children:"To use newer protocols like WiFi 6-e and 7, users can not fall back to WPA2, which is excellent\nsince WPA2 suffers from passive sniffing & password cracking attacks."}),"\n",(0,i.jsx)(t.p,{children:"WPA3 provides a zero knowledge proof: there's no handshake to sniff and crack -- but the protocol is rigid and makes it hard\nto support multi-pass. So most products only do it for WPA2 sadly, meaning they can't operate on 6-e or 7. This leaves users making more bad security tradeoffs.\nSPR works to give people the best security choices by default but the user experience could still vastly improve."}),"\n",(0,i.jsxs)(t.p,{children:["A new project, ",(0,i.jsx)(t.a,{href:"https://github.com/DistriNet/decoyauth",children:"DecoyAuth"}),", by Mathy Vanhoef, seeks to do that just that and make WPA3 better support multipass."]}),"\n",(0,i.jsxs)(t.p,{children:["The project was presented at PAKE25 and the ",(0,i.jsx)(t.a,{href:"https://github.com/DistriNet/decoyauth/blob/main/docs/pake2025-slides.pdf",children:"slides"})," are here."]}),"\n",(0,i.jsx)(t.h2,{id:"the-challenges-of-wpa3-multipass",children:"The Challenges of WPA3 Multipass"}),"\n",(0,i.jsx)(t.p,{children:"One of the key aspects of multipass is that the password's also the secret that marks the identity of the device.\nWith WPA2, an AP enumerates the passwords it has to identify which devices authenticated, and map it to its VLAN/network."}),"\n",(0,i.jsx)(t.p,{children:"With WPA3, the zero knowledge proof commitments in SAE mean the AP can only attempt one password per authentication.\nThis leaves the MAC as the guide for identifying a device. And the protocol in effect can only accept new devices with a wildcard key."}),"\n",(0,i.jsx)(t.p,{children:"This is what SPR does to support multi-auth for WPA3.  But it has several shortcomings:"}),"\n",(0,i.jsx)(t.h4,{id:"1-only-one-device-can-be-added-at-a-time",children:"1. Only one device can be added at a time"}),"\n",(0,i.jsxs)(t.p,{children:['There\'s no way to add N devices with N unique passwords out of order. It must be done sequentially,\nduring a "registration" phase. This is the ',(0,i.jsx)(t.code,{children:"Add Device"})," flow on SPR. When the new device shows up, the MAC is assigned to that password."]}),"\n",(0,i.jsx)(t.h4,{id:"2-mac-randomization",children:"2. MAC Randomization"}),"\n",(0,i.jsx)(t.p,{children:"If a device randomizes it's MAC, it must be reassigned to the network, or a fixed MAC should be set.\nThis means there's now a privacy tradeoff where the MAC can't rotate"}),"\n",(0,i.jsx)(t.h4,{id:"3-password-sync-breakage",children:"3. Password Sync Breakage"}),"\n",(0,i.jsx)(t.p,{children:"When Apple devices force password syncing, they all have different MACs. SPR admins have\nto share the wifi password between all the apple devices, limiting isolation between the ecosystem.\nFor example, an apple tv, apple watch, and iphone all end up being able to impersonate each other."}),"\n",(0,i.jsx)(t.p,{children:'Addressing these would be amazing for SPR users since they can enjoy multipass without worrying about the above which are more or less a "security tax".\nWe should stop designing protocols with security taxes, the best security should be free and effortless, by default.'}),"\n",(0,i.jsx)(t.h3,{id:"existing-workarounds",children:"Existing Workarounds"}),"\n",(0,i.jsx)(t.p,{children:"The IEEE standard does provide a way to pass an identity for SAE to help work around this.\nQR Codes can specify an identifier. However many clients dont allow manual entry of the identifier when entering a password.\nThis limits how well this can be applied."}),"\n",(0,i.jsx)(t.p,{children:"Another shortcoming Vanhoef points out in DecoyAuth is that the identifiers leak in plaintext, and allow user tracking."}),"\n",(0,i.jsx)(t.h2,{id:"decoyauth-proposes-advancing-oblivious-pake-o-pake-to-resolve-wpa3-multipass",children:"DecoyAuth Proposes Advancing Oblivious PAKE (O-PAKE) to resolve WPA3 Multipass"}),"\n",(0,i.jsx)(t.p,{children:"The naive base case is to perform the SAE protocol, for each password, in parallel. This means as more devices\nare on the network, this is not really feasible, as this causes a linearly increasing amount of packet spam."}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.a,{href:"https://eprint.iacr.org/2013/127.pdf",children:"O-PAKE"})," protocols seek to instead allow peers to efficiently try multiple passwords using interpolation."]}),"\n",(0,i.jsxs)(t.p,{children:["The ",(0,i.jsx)(t.a,{href:"https://github.com/DistriNet/decoyauth",children:"DecoyAuth Project"})," solving O-PAKE for WPA3's Dragonfly."]}),"\n",(0,i.jsx)(t.p,{children:"The current best proposed approach has the following characteristics where N is the number of passwords:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"A polynomial interpolation can be broadcast to all clients (with O(n) size)"}),"\n",(0,i.jsx)(t.li,{children:"AP does O(N) work to authenticate and identify a client"}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"a-call-to-action",children:"A Call To Action"}),"\n",(0,i.jsx)(t.p,{children:"The need for user friendly WPA3 Multipass is clear."}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"The current OPAKE solution breaks down as clients are added. Can many clients be supported?"}),"\n",(0,i.jsx)(t.li,{children:"The protocol needs cryptographic security analysis"}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"decoy-auth",src:s(18708).Z+"",width:"2258",height:"1102"})})]})}function h(e={}){const{wrapper:t}={...(0,n.a)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},18708:(e,t,s)=>{s.d(t,{Z:()=>i});const i=s.p+"assets/images/decoyauth-1-aec39fd14c80cb98fa350628e98c5f0d.jpg"},11151:(e,t,s)=>{s.d(t,{Z:()=>r,a:()=>o});var i=s(67294);const n={},a=i.createContext(n);function o(e){const t=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:o(e.components),i.createElement(a.Provider,{value:t},e.children)}}}]);